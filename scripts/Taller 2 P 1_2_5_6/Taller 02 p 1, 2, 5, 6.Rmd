---
title: "Taller 02 puntos 1, 2, 5 y 6"
output: html_document
date: "2025-05-03"
---

## Instalar las librer√≠as necesarias

```{r libraries}
#install.packages("plotly")
#install.packages("MASS")
#install.packages("psych")
#install.packages("tidyverse")
#install.packages("factoextra")
#install.packages("GGally")
#install.packages("corrplot")
#install.packages("psych")
#install.packages("writexl")
#install.packages("GGally")

library(GGally)
library(writexl)
library(plotly)
library(MASS)
library(psych)
library(tidyverse)
library(factoextra)
library(FactoMineR)
library(GGally)
library(corrplot)
library(psych)
library(ggplot2)
```

## Importar el dataset

```{r dataset}
datos_taller_02 <- read.csv("/cloud/project/datos_taller_02.csv", header=TRUE, sep=";")
```

## Punto 1

Encuentre la estimaci√≥n del vector de medias y la matriz de varianzas y covarianzas para 5 variables de su inter√©s del conjunto de datos.

### Vector de Medias
```{r vector de medias}
# Seleccionar las 5 variables de inter√©s
vars_interes <- datos_taller_02[, c(12, 16, 17, 40, 58)]

# Estimaci√≥n del vector de medias
vector_medias <- colMeans(vars_interes)
print(vector_medias)
```
Unidades en las que se miden las variables a estudiar:
- TBPD (Thousand Barrels Per Day) 
- BKWH (Billion Kilowatt-hours)

Se observa que el promedio de consumo de gasolina es muy alto en comparaci√≥n con otras variables, y que la generaci√≥n e√≥lica todav√≠a es baja en promedio.

### Matriz de varianzas y covarianzas
```{r Matriz de varianzas y cov} 
# Estimaci√≥n de la matriz de varianzas y covarianzas
matriz_covarianzas <- cov(vars_interes)
print(matriz_covarianzas)
```
Las covarianzas (situadas fuera de la diagonal de la matriz) indican c√≥mo dos variables interactuan. Los valores positivos indican relaci√≥n directa o positiva, los valores negativos indican una relaci√≥n indirecta o negativa, es decir, mientra una aumenta la otra disminuye. Y por √∫ltimo, si el valor es cero o cercano a cero, indica que las variables no tienen relaci√≥n. 


Podemos concluir que:

- Motor_gasoline_consumption y production:
Covarianza ‚âà 834206.42 m
Covarianza muy alta y positiva: los pa√≠ses que consumen m√°s gasolina tambi√©n tienden a producir m√°s.

- Kerosene y gasoline consumption:
Covarianza ‚âà 3652.59
Covarianza: positiva pero peque√±a ‚Üí Existe relaci√≥n entre las variables, pero no muy fuerte.

- Wind electricity vs. cualquier otra:
Covarianzas bajas (ej. con f√≥sil ‚âà 10183.49, con gasolina ‚âà 18042.27), la generaci√≥n e√≥lica no tiene una fuerte relaci√≥n lineal con las dem√°s variables.



A continuaci√≥n, se muestra la diagonal de la matriz de varianzas y covarianzas, que representan la varianza de cada variable, es decir, qu√© tanto se dispersan los datos respecto a su media.
```{r Varianzas} 
# Varianza de cada una de las variables
print (diag(matriz_covarianzas))
```
- La producci√≥n y consumo de gasolina tienen alt√≠sima varianza, lo que sugiere grandes diferencias entre pa√≠ses.

- La generaci√≥n e√≥lica tiene baja varianza, lo que indica que la mayor√≠a de los pa√≠ses tienen valores similares (probablemente bajos).

- La generaci√≥n el√©ctrica por f√≥siles tambi√©n muestra alta varianza, lo cual refleja diferencias estructurales entre pa√≠ses en sus sistemas el√©ctricos.


## PUNTO 2
Realice un an√°lisis descriptivo univariado y bivariado del conjunto de datos. Considere nuevamente las mismas 5 variables de su inter√©s para este punto.

### An√°lisis univariado 
Resumen estad√≠stico

```{r summary} 
summary(vars_interes)
```

Desviaci√≥n est√°ndar para cada variable
```{r standard deviation} 
sapply(vars_interes, sd, na.rm = TRUE)
```

#### Histograma de distribuci√≥n para cada variable
Histograma de distribuci√≥n Kerosene_consumption_TBPD
```{r}
ggplot(vars_interes, aes(x = Kerosene_consumption_TBPD)) +
  geom_histogram(fill = "steelblue", color = "white", bins = 50) +
  labs(title = "Distribuci√≥n de Kerosene_consumption_TBPD",
       x = "Consumo (TBPD)",
       y = "Frecuencia")
```
Histograma de distribuci√≥n Motor_gasoline_consumption_TBPD
```{r}
ggplot(vars_interes, aes(x = Motor_gasoline_consumption_TBPD)) +
  geom_histogram(fill = "steelblue", color = "white", bins = 50) +
  labs(title = "Distribuci√≥n de Motor_gasoline_consumption_TBPD",
       x = "Consumo (TBPD)",
       y = "Frecuencia")
```

Histograma de distribuci√≥n Motor_gasoline_production_TBPD
```{r}
ggplot(vars_interes, aes(x = Motor_gasoline_production_TBPD)) +
  geom_histogram(fill = "steelblue", color = "white", bins = 50) +
  labs(title = "Distribuci√≥n de Motor_gasoline_production_TBPD",
       x = "Consumo (TBPD)",
       y = "Frecuencia")
```

Histograma de distribuci√≥n Fossil_fuels_electricity_net_generation_BKWH
```{r}
ggplot(vars_interes, aes(x = Fossil_fuels_electricity_net_generation_BKWH)) +
  geom_histogram(fill = "steelblue", color = "white", bins = 50) +
  labs(title = "Distribuci√≥n de Fossil_fuels_electricity_net_generation_BKWH",
       x = "Consumo (BKWH)",
       y = "Frecuencia")
```

Histograma de distribuci√≥n Fossil_fuels_electricity_net_generation_BKWH
```{r}
ggplot(vars_interes, aes(x = Wind_electricity_net_generation_BKWH)) +
  geom_histogram(fill = "steelblue", color = "white", bins = 50) +
  labs(title = "Distribuci√≥n de Wind_electricity_net_generation_BKWH",
       x = "Consumo (BKWH)",
       y = "Frecuencia")
```
#### Boxplots
Boxplot Kerosene_consumption_TBPD
```{r}
boxplot(vars_interes$Kerosene_consumption_TBPD)
```

Boxplot Motor_gasoline_consumption_TBPD
```{r}
boxplot(vars_interes$Motor_gasoline_consumption_TBPD)
```

Boxplot Motor_gasoline_production_TBPD
```{r}
boxplot(vars_interes$Motor_gasoline_production_TBPD)
```

Boxplot Fossil_fuels_electricity_net_generation_BKWH
```{r}
boxplot(vars_interes$Fossil_fuels_electricity_net_generation_BKWH)
```

Boxplot Wind_electricity_net_generation_BKWH
```{r}
boxplot(vars_interes$Wind_electricity_net_generation_BKWH)
```

### An√°lisis multivariado 

La matriz de correlaci√≥n indica la fuerza y direcci√≥n de las relaciones lineales entre las variables de un conjunto de datos.
```{r}
correlaciones <- cor(vars_interes, use = "complete.obs")
print(correlaciones)
```
- Alta correlaci√≥n entre Motor_gasoline_consumption_TBPD y Motor_gasoline_production_TBPD: 0.9945. Esto indica una relaci√≥n casi perfecta. Los pa√≠ses que m√°s gasolina producen tambi√©n la consumen mucho.

- Alta correlaci√≥n entre entre Fossil_fuels_electricity_net_generation_BKWH y Wind_electricity_net_generation_BKWH: 0.9070. Los pa√≠ses que generan m√°s electricidad con f√≥siles tambi√©n tienen alta generaci√≥n e√≥lica.

- Correlaci√≥n fuerte entre Motor_gasoline_production_TBPD y Wind_electricity_net_generation_BKWH: 0.8571. Los paises con alta producci√≥n de gasolina, tambi√©n tienen una alta generaci√≥n neta de electricidad e√≥lica.

- Kerosene_consumption_TBPD tiene correlaciones d√©biles con todas las dem√°s (< 0.29).

```{r}
ggpairs(vars_interes)
```
La mayor√≠a de las variables tienen distribuciones sesgadas hacia valores bajos con algunos valores muy altos (ver diagramas de dispersi√≥n).

Esto sugiere que la mayor√≠a de los pa√≠ses tienen baja producci√≥n o consumo, mientras que unos pocos tienen valores extremos.

## PUNTO 5
Analice la representaci√≥n de las variables originales sobre las dos primeras componentes en el primer plano factorial. ¬øQue conclusiones podemos sacar de este an√°lisis?

```{r}
datos <- subset(datos_taller_02, select = -Country )

# Ejecutar el PCA 
res.pca <- PCA(datos, graph = FALSE)

# Visualizar las variables en el primer plano factorial
fviz_pca_var(res.pca,
             axes = c(1, 2),
             repel = TRUE,
             col.var = "contrib",
             gradient.cols = c("orange", "blue"),
             labelsize = 2,
             select.var = list(contrib = 30)) +  # üîç Selecciona las 10 variables m√°s importantes
  ggtitle("Top 30 Variables m√°s Contributivas al PCA")

```
```{r}
# Visualizar las variables en el primer plano factorial
fviz_pca_var(res.pca,
             axes = c(2, 3),
             repel = TRUE,
             col.var = "contrib",
             gradient.cols = c("orange", "blue"),
             labelsize = 2,
             select.var = list(contrib = 30)) +  # üîç Selecciona las 10 variables m√°s importantes
  ggtitle("Top 30 Variables m√°s Contributivas al PCA")

```

## PUNTO 6
Ahora examine con detenimiento el mapa de individuos sobre los planos factoriales que conforman las componentes (1,2) y (2,3). ¬øQu√© conclusiones puede sacar seg√∫n la cercan√≠a de algunas UE?

```{r}
fviz_pca_ind(res.pca, geom.ind = "point", 
             col.ind = "#FC4E07", 
             axes = c(1, 2), 
             pointsize = 1.5) 
```
Dim1 (62%):

- Este eje captura la mayor parte de la variabilidad, sugiriendo que una √∫nica dimensi√≥n ordena eficientemente a los pa√≠ses.

- Rango de valores: Los pa√≠ses se distribuyen desde -10 (extremo izquierdo) hasta 40 (extremo derecho), indicando una fuerte polarizaci√≥n.

Dim2 (7.7%):

- Su contribuci√≥n parece marginal, por lo que el an√°lisis se centra en Dim1 (62%).

Distribuci√≥n de Pa√≠ses

Patr√≥n de dispersi√≥n:

- Extremo derecho: Pa√≠ses con caracter√≠sticas inusuales.

- Centro (valores cercanos a 0): Pa√≠ses con perfiles energ√©ticos similares.

- Extremo izquierdo (valores negativos): Pa√≠ses con patrones at√≠picos.



```{r}
fviz_pca_ind(res.pca, geom.ind = "point", 
             col.ind = "blue", 
             axes = c(2, 3), 
             pointsize = 1.5) 
```
Dim3 (7%) y Dim2 (7.7%):

Ambos componentes explican una proporci√≥n baja de varianza total (14.7% combinada). Esto sugiere que:

- La estructura subyacente de los datos es alta-dimensional (muchas variables influyentes no capturadas en estos ejes).

Distribuci√≥n de Pa√≠ses

- Los puntos (pa√≠ses) est√°n dispersos en un rango de -10 a 10 en ambos ejes, sin agrupamientos claros. Esto indica:

- No hay perfiles dominantes que agrupen a m√∫ltiples pa√≠ses.

- Outliers potenciales: Pa√≠ses en extremos (ej., cerca de (-10, 10)) podr√≠an ser casos at√≠picos.



